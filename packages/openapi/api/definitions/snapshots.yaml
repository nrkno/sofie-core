title: snapshots
description: Definitions for Snapshots API
resources:
  snapshots:
    post:
      operationId: storeSnapshot
      tags:
        - snapshots
      summary: Stores a Snapshot.
      parameters:
        - in: header
          name: Idempotency-Key
          description: 'Unique ID generated by the client, helping to prevent unintended side effects or duplicate operations caused by retransmissions or retries of the same request. Expiry period: 5 minutes.'
          schema:
            type: string
            format: uuid
            example: faf1ba52-a1b5-4958-9baa-b91727ace097
          required: true
      requestBody:
        required: true
        content:
          application/json:
            schema:
              oneOf:
                - $ref: '#/components/schemas/storeSystemSnapshotRequestBody'
                - $ref: '#/components/schemas/storePlaylistSnapshotRequestBody'
              discriminator:
                propertyName: snapshotType
                mapping:
                  system: '#/components/schemas/storeSystemSnapshotRequestBody'
                  playlist: '#/components/schemas/storePlaylistSnapshotRequestBody'
      responses:
        200:
          description: Command successfully handled - returns a snapshot id.
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: number
                    example: 200
                  result:
                    type: string
                    description: Snapshot Id.
        500:
          $ref: '#/components/responses/internalServerError'
        400:
          description: Provided `snapshotType` is invalid or `Idempotency-Key` is missing
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: number
                    example: 400
                  message:
                    type: string
                required:
                  - status
                  - message
                additionalProperties: false
        429:
          description: Rate limit exceeded
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: number
                    example: 429
                  message:
                    type: string
                required:
                  - status
                  - message
                additionalProperties: false
        422:
          description: Idempotency-Key is already used
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: number
                    example: 422
                  message:
                    type: string
                required:
                  - status
                  - message
                additionalProperties: false
components:
  responses:
    internalServerError:
      description: An error unlikely to be the fault of the caller has occurred.
      content:
        application/json:
          schema:
            type: object
            properties:
              status:
                type: number
                example: 500
              message:
                type: string
            required:
              - status
              - message
            additionalProperties: false
  schemas:
    storeSnapshotRequestBody:
      type: object
      required:
        - snapshotType
        - reason
      properties:
        snapshotType:
          type: string
        reason:
          type: string
          description: Reason this snapshot is stored.
          example: Bug report from a user
        withDeviceSnapshots:
          type: boolean
          description: If Peripheral Device snapshots should be included.
      discriminator:
        propertyName: type
    storeSystemSnapshotRequestBody:
      allOf:
        - $ref: '#/components/schemas/storeSnapshotRequestBody'
        - type: object
          properties:
            studioId:
              type: string
              description: When provided, only data related to that Studio will be stored.
              example: studio0
    storePlaylistSnapshotRequestBody:
      allOf:
        - $ref: '#/components/schemas/storeSnapshotRequestBody'
        - type: object
          required:
            - rundownPlaylistId
          properties:
            rundownPlaylistId:
              type: string
              description: Id of the Playlist to take a Snapshot of.
              example: OKAgZmZ0Buc99lE_2uPPSKVbMrQ_
            withTimeline:
              type: boolean
              description: If the Timeline should be included.
            withArchivedDocuments:
              type: boolean
              description: If played out but already reset instances of Parts and Pieces should be included.
