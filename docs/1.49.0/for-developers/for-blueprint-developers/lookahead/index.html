<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-1.49.0 plugin-docs plugin-id-default docs-doc-id-for-developers/for-blueprint-developers/lookahead">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.20">
<link rel="search" type="application/opensearchdescription+xml" title="Sofie TV Automation Documentation" href="/sofie-core/opensearch.xml"><title data-rh="true">Lookahead | Sofie TV Automation Documentation</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://nrkno.github.io/sofie-core/img/pilot_fredag-05.jpg"><meta data-rh="true" name="twitter:image" content="https://nrkno.github.io/sofie-core/img/pilot_fredag-05.jpg"><meta data-rh="true" property="og:url" content="https://nrkno.github.io/sofie-core/docs/1.49.0/for-developers/for-blueprint-developers/lookahead"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="1.49.0"><meta data-rh="true" name="docusaurus_tag" content="docs-default-1.49.0"><meta data-rh="true" name="docsearch:version" content="1.49.0"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-1.49.0"><meta data-rh="true" property="og:title" content="Lookahead | Sofie TV Automation Documentation"><meta data-rh="true" name="description" content="Lookahead allows Sofie to look into future Parts and Pieces, in order to preload or preview what is coming up. The aim is to fill in the gaps between your TimelineObjects with lookahead versions of these objects."><meta data-rh="true" property="og:description" content="Lookahead allows Sofie to look into future Parts and Pieces, in order to preload or preview what is coming up. The aim is to fill in the gaps between your TimelineObjects with lookahead versions of these objects."><link data-rh="true" rel="icon" href="/sofie-core/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://nrkno.github.io/sofie-core/docs/1.49.0/for-developers/for-blueprint-developers/lookahead"><link data-rh="true" rel="alternate" href="https://nrkno.github.io/sofie-core/docs/1.49.0/for-developers/for-blueprint-developers/lookahead" hreflang="en"><link data-rh="true" rel="alternate" href="https://nrkno.github.io/sofie-core/docs/1.49.0/for-developers/for-blueprint-developers/lookahead" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://0J21XARTCE-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/sofie-core/assets/css/styles.fc8a9fbd.css">
<link rel="preload" href="/sofie-core/assets/js/runtime~main.2e85f4d6.js" as="script">
<link rel="preload" href="/sofie-core/assets/js/main.91440fd8.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_BxGa">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/sofie-core/"><div class="navbar__logo"><img src="/sofie-core/img/sofie-logo.svg" alt="Sofie Logo" class="themedImage_aIr_ themedImage--light_DGIu"><img src="/sofie-core/img/sofie-logo.svg" alt="Sofie Logo" class="themedImage_aIr_ themedImage--dark_RoHN"></div><b class="navbar__title text--truncate">Sofie TV Automation</b></a><a class="navbar__item navbar__link" href="/sofie-core/docs/user-guide/intro">User Guide</a><a class="navbar__item navbar__link" href="/sofie-core/docs/for-developers/intro">For Developers</a><a class="navbar__item navbar__link" href="/sofie-core/releases">Releases</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/sofie-core/docs/1.49.0/user-guide/intro">1.49.0</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/sofie-core/docs/for-developers/for-blueprint-developers/lookahead">Latest</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/sofie-core/docs/1.49.0/for-developers/for-blueprint-developers/lookahead">1.49.0</a></li><li><a class="dropdown__link" href="/sofie-core/docs/1.47.0/for-developers/for-blueprint-developers/lookahead">1.47.0</a></li><li><a class="dropdown__link" href="/sofie-core/docs/1.46.0/user-guide/intro">1.46.0</a></li><li><a class="dropdown__link" href="/sofie-core/docs/1.41.0/user-guide/intro">1.41.0</a></li><li><a class="dropdown__link" href="/sofie-core/docs/1.38.0/user-guide/intro">1.38.0</a></li><li><a class="dropdown__link" href="/sofie-core/docs/1.37.0/user-guide/intro">1.37.0</a></li></ul></div><a href="https://github.com/nrkno/sofie-core" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_GWqj"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_IT2h colorModeToggle_o_qc"><button class="clean-btn toggleButton_pGki toggleButtonDisabled_vZLo" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_dYsV"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_WRF1"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_WxAN"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_i7DT"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_ecpa" type="button"></button><div class="docPage_ECkl"><aside class="theme-doc-sidebar-container docSidebarContainer_cJdQ"><div class="sidebar_Uz2u"><nav class="menu thin-scrollbar menu_XU2j"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/sofie-core/docs/1.49.0/for-developers/intro">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/sofie-core/docs/1.49.0/for-developers/contribution-guidelines">Contribution Guidelines</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/sofie-core/docs/1.49.0/for-developers/for-blueprint-developers/intro">For Blueprint Developers</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/sofie-core/docs/1.49.0/for-developers/for-blueprint-developers/intro">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/sofie-core/docs/1.49.0/for-developers/for-blueprint-developers/ab-playback">AB Playback</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/sofie-core/docs/1.49.0/for-developers/for-blueprint-developers/hold">Hold</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/sofie-core/docs/1.49.0/for-developers/for-blueprint-developers/lookahead">Lookahead</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/sofie-core/docs/1.49.0/for-developers/for-blueprint-developers/part-and-piece-timings">Part and Piece Timings</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/sofie-core/docs/1.49.0/for-developers/for-blueprint-developers/timeline-datastore">Timeline Datastore</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/sofie-core/docs/1.49.0/for-developers/libraries">Applications &amp; Libraries</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/sofie-core/docs/1.49.0/for-developers/api-documentation">API Documentation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/sofie-core/docs/1.49.0/for-developers/worker-threads-and-locks">Worker Threads &amp; Locks</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_Essf"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_bqna"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_tUyt"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_ygLL"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->Sofie TV Automation Documentation<!-- --> <b>1.49.0</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/sofie-core/docs/for-developers/for-blueprint-developers/lookahead">latest version</a></b> (<!-- -->Latest<!-- -->).</div></div><div class="docItemContainer_yJzi"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_nmcO" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/sofie-core/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_fy9r"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">For Blueprint Developers</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Lookahead</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 1.49.0</span><div class="tocCollapsible_mE9n theme-doc-toc-mobile tocMobile_By44"><button type="button" class="clean-btn tocCollapsibleButton_Yex_">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Lookahead</h1><p>Lookahead allows Sofie to look into future Parts and Pieces, in order to preload or preview what is coming up. The aim is to fill in the gaps between your TimelineObjects with lookahead versions of these objects.<br>
<!-- -->In this way, it can be used to provide functionality such as an AUX on your vision mixer showing the next cut, or to load the next clip into the media player.</p><h2 class="anchor anchorWithStickyNavbar_YDjN" id="defining">Defining<a class="hash-link" href="#defining" title="Direct link to heading">​</a></h2><p>Lookahead can be enabled by configuring a few properties on a mapping:</p><div class="language-ts codeBlockContainer_KHZ4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_VL6T"><pre tabindex="0" class="prism-code language-ts codeBlock_Qbkr thin-scrollbar"><code class="codeBlockLines_HKiK"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/** What method core should use to create lookahead objects for this layer */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lookahead</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> LookaheadMode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">/** The minimum number lookahead objects to create from future parts for this layer. Default = 1 */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lookaheadDepth</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">/** Maximum distance to search for lookahead. Default = undefined */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lookaheadMaxSearchDistance</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">number</span><br></span></code></pre><div class="buttonGroup_uP1X"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Uqyx" aria-hidden="true"><svg class="copyButtonIcon_CtfL" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Mq1p" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>With <code>LookaheadMode</code> defined as:</p><div class="language-ts codeBlockContainer_KHZ4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_VL6T"><pre tabindex="0" class="prism-code language-ts codeBlock_Qbkr thin-scrollbar"><code class="codeBlockLines_HKiK"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">enum</span><span class="token plain"> LookaheadMode </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">     * Disable lookahead for this layer</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token constant" style="color:#36acaa">NONE</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">     * Preload content with a secondary layer.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">     * This requires support from the TSR device, to allow for preloading on a resource at the same time as it being on air.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">     * For example, this allows for your TimelineObjects to control the foreground of a CasparCG layer, with lookahead controlling the background of the same layer.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token constant" style="color:#36acaa">PRELOAD</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">     * Fill the gaps between the planned objects on a layer.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">     * This is the primary lookahead mode, and appears to TSR devices as a single layer of simple objects.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token constant" style="color:#36acaa">WHEN_CLEAR</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_uP1X"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Uqyx" aria-hidden="true"><svg class="copyButtonIcon_CtfL" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Mq1p" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If undefined, <code>lookaheadMaxSearchDistance</code> currently has a default distance of 10 parts. This number was chosen arbitrarily, and could change in the future. Be careful when choosing a distance to not set it too high. All the Pieces from the parts being searched have to be loaded from the database, which can come at a noticable cost.</p><p>If you are doing <a href="/sofie-core/docs/1.49.0/for-developers/for-blueprint-developers/ab-playback">AB Playback</a>, or performing some other processing of the timeline in <code>onTimelineGenerate</code>, you may benefit from increasing the value of <code>lookaheadDepth</code>. In the case of AB Playback, you will likely want to set it to the number of players available in your pool.</p><p>Typically, TimelineObjects do not need anything special to support lookahead, other than a sensible <code>priority</code> value. Lookahead objects are given a priority between <code>0</code> and <code>0.1</code>. Generally, your baseline objects should have a priority of <code>0</code> so that they are overridden by lookahead, and any objects from your Parts and Pieces should have a priority of <code>1</code> or higher, so that they override lookahead objects.</p><p>If there are any keyframes on TimelineObjects that should be preserved when being converted to a lookahead object, they will need the <code>preserveForLookahead</code> property set.</p><h2 class="anchor anchorWithStickyNavbar_YDjN" id="how-it-works">How it works<a class="hash-link" href="#how-it-works" title="Direct link to heading">​</a></h2><p>Lookahead is calculated while the timeline is being built, and searches based on the playhead, rather than looking at the planned Parts.</p><p>The searching operates per-layer first looking at the current PartInstance, then the next PartInstance and then any Parts after the next PartInstance in the rundown. Any Parts marked as <code>invalid</code> or <code>floated</code> are ignored. This is what allows lookahead to be dynamic based on what the User is doing and intending to play.</p><p>It is searching Parts in that order, until it has either searched through the <code>lookaheadMaxSearchDistance</code> number of Parts, or has found at least <code>lookaheadDepth</code> future timeline objects.</p><p>Any pieces marked as <code>pieceType: IBlueprintPieceType.InTransition</code> will be considered only if playout intends to use the transition.<br>
<!-- -->If an object is found in both a normal piece with <code>{ start: 0 }</code> and in an InTransition piece, then the objects from the normal piece will be ignored.</p><p>These objects are then processed and added to the timeline. This is done in one of two ways:</p><ol><li><p>As timed objects.<br>
<!-- -->If the object selected for lookahead is already on the timeline (it is in the current part, or the next part and autonext is enabled), then timed lookahead objects are generated. These objects are to fill in the gaps, and get their <code>enable</code> object to reference the objects on the timeline that they are filling between.
The <code>lookaheadDepth</code> setting of the mapping is ignored for these objects.</p></li><li><p>As future objects.<br>
<!-- -->If the object selected for lookahead is not on the timeline, then simpler objects are generated. Instead, these get an enable of either <code>{ while: &#x27;1&#x27; }</code>, or set to start after the last timed object on that layer. This lets them fill all the time after any other known objects.<br>
<!-- -->The <code>lookaheadDepth</code> setting of the mapping is respected for these objects, with this number defining the <strong>minimum</strong> number future objects that will be produced. These future objects are inserted with a decreasing <code>priority</code>, starting from 0.1 decreasing down to but never reaching 0.<br>
<!-- -->When using the <code>WHEN_CLEAR</code> lookahead mode, all but the first will be set as <code>disabled</code>, to ensure they aren&#x27;t considered for being played out. These <code>disabled</code> objects can be used by <code>onTimelineGenerate</code>, or they will be dropped from the timeline if left <code>disabled</code>.<br>
<!-- -->When there are multiple future objects on a layer, only the first is useful for playout directly, but the others are often utilised for <a href="/sofie-core/docs/1.49.0/for-developers/for-blueprint-developers/ab-playback">AB Playback</a></p></li></ol><p>Some additional changes done when processing each lookahead timeline object:</p><ul><li>The <code>id</code> is processed to be unique</li><li>The <code>isLookahead</code> property is set as true</li><li>If the object has any keyframes, any not marked with <code>preserveForLookahead</code> are removed</li><li>The object is removed from any group it was contained within</li><li>If the lookahead mode used is <code>PRELOAD</code>, then the layer property is changed, with the <code>lookaheadForLayer</code> property set to indicate the layer it is for.</li></ul><p>The resulting objects are appended to the timeline and included in the call to <code>onTimelineGenerate</code> and the <a href="/sofie-core/docs/1.49.0/for-developers/for-blueprint-developers/ab-playback">AB Playback</a> resolving.</p><h2 class="anchor anchorWithStickyNavbar_YDjN" id="advanced-scenarios">Advanced Scenarios<a class="hash-link" href="#advanced-scenarios" title="Direct link to heading">​</a></h2><p>Because the lookahead objects are included in the timeline to <code>onTimelineGenerate</code>, this gives you the ability to make changes to the lookahead output.</p><p><a href="/sofie-core/docs/1.49.0/for-developers/for-blueprint-developers/ab-playback">AB Playback</a> started out as being implemented inside of <code>onTimelineGenerate</code> and relies on lookahead objects being produced before reassigning them to other mappings.</p><p>If any objects found by lookahead have a class <code>_lookahead_start_delay</code>, they will be given a short delay in their start time. This is a hack introduced to workaround a timing issue. At some point this will be removed once a proper solution is found.</p><p>Sometimes it can be useful to have keyframes which are only applied when in lookahead. That can be achieved by setting <code>preserveForLookahead</code>, making the keyframe be disabled, and then re-enabling it inside <code>onTimelineGenerate</code> at the correct time.</p><p>It is possible to implement a &#x27;next&#x27; AUX on your vision mixer by:</p><ul><li>Setup this mapping with <code>lookaheadDepth: 1</code> and <code>lookahead: LookaheadMode.WHEN_CLEAR</code></li><li>Each Part creates a TimelineObject on this mapping. Crucially, these have a priority of 0.</li><li>Lookahead will run and will insert its objects overriding your predefined ones (because of its higher priority). Resulting in the AUX always showing the lookahead object.</li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/nrkno/sofie-core/edit/master/packages/documentation/versioned_docs/version-1.49.0/for-developers/for-blueprint-developers/lookahead.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_OMbO" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vA0S"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/sofie-core/docs/1.49.0/for-developers/for-blueprint-developers/hold"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Hold</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/sofie-core/docs/1.49.0/for-developers/for-blueprint-developers/part-and-piece-timings"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Part and Piece Timings</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_jWtb thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#defining" class="table-of-contents__link toc-highlight">Defining</a></li><li><a href="#how-it-works" class="table-of-contents__link toc-highlight">How it works</a></li><li><a href="#advanced-scenarios" class="table-of-contents__link toc-highlight">Advanced Scenarios</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" position="left" href="/sofie-core/docs/user-guide/intro">User Guide</a></li><li class="footer__item"><a class="footer__link-item" position="left" href="/sofie-core/docs/for-developers/intro">For Developers</a></li><li class="footer__item"><a class="footer__link-item" position="left" href="/sofie-core/releases">Releases</a></li></ul></div><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://join.slack.com/t/sofietv/shared_invite/zt-2bfz8l9lw-azLeDB55cvN2wvMgqL1alA" target="_blank" rel="noopener noreferrer" class="footer__link-item">Sofie Slack Community<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_GWqj"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" position="right" href="/sofie-core/docs/about-sofie">About Sofie</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ©2024 Norsk rikskringkasting AS and Contributors</div></div></div></footer></div>
<script src="/sofie-core/assets/js/runtime~main.2e85f4d6.js"></script>
<script src="/sofie-core/assets/js/main.91440fd8.js"></script>
</body>
</html>