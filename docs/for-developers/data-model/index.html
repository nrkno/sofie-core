<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-for-developers/data-model">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.20">
<link rel="search" type="application/opensearchdescription+xml" title="Sofie TV Automation Documentation" href="/sofie-core/opensearch.xml"><title data-rh="true">Data Model | Sofie TV Automation Documentation</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://nrkno.github.io/sofie-core/img/pilot_fredag-05.jpg"><meta data-rh="true" name="twitter:image" content="https://nrkno.github.io/sofie-core/img/pilot_fredag-05.jpg"><meta data-rh="true" property="og:url" content="https://nrkno.github.io/sofie-core/docs/for-developers/data-model"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Data Model | Sofie TV Automation Documentation"><meta data-rh="true" name="description" content="Sofie persists the majority of its data in a MongoDB database. This allows us to use Typescript friendly documents,"><meta data-rh="true" property="og:description" content="Sofie persists the majority of its data in a MongoDB database. This allows us to use Typescript friendly documents,"><link data-rh="true" rel="icon" href="/sofie-core/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://nrkno.github.io/sofie-core/docs/for-developers/data-model"><link data-rh="true" rel="alternate" href="https://nrkno.github.io/sofie-core/docs/for-developers/data-model" hreflang="en"><link data-rh="true" rel="alternate" href="https://nrkno.github.io/sofie-core/docs/for-developers/data-model" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://0J21XARTCE-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/sofie-core/assets/css/styles.fc8a9fbd.css">
<link rel="preload" href="/sofie-core/assets/js/runtime~main.2e85f4d6.js" as="script">
<link rel="preload" href="/sofie-core/assets/js/main.91440fd8.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_BxGa">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/sofie-core/"><div class="navbar__logo"><img src="/sofie-core/img/sofie-logo.svg" alt="Sofie Logo" class="themedImage_aIr_ themedImage--light_DGIu"><img src="/sofie-core/img/sofie-logo.svg" alt="Sofie Logo" class="themedImage_aIr_ themedImage--dark_RoHN"></div><b class="navbar__title text--truncate">Sofie TV Automation</b></a><a class="navbar__item navbar__link" href="/sofie-core/docs/user-guide/intro">User Guide</a><a class="navbar__item navbar__link" href="/sofie-core/docs/for-developers/intro">For Developers</a><a class="navbar__item navbar__link" href="/sofie-core/releases">Releases</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/sofie-core/docs/user-guide/intro">Latest</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/sofie-core/docs/for-developers/data-model">Latest</a></li><li><a class="dropdown__link" href="/sofie-core/docs/1.49.0/user-guide/intro">1.49.0</a></li><li><a class="dropdown__link" href="/sofie-core/docs/1.47.0/user-guide/intro">1.47.0</a></li><li><a class="dropdown__link" href="/sofie-core/docs/1.46.0/user-guide/intro">1.46.0</a></li><li><a class="dropdown__link" href="/sofie-core/docs/1.41.0/user-guide/intro">1.41.0</a></li><li><a class="dropdown__link" href="/sofie-core/docs/1.38.0/user-guide/intro">1.38.0</a></li><li><a class="dropdown__link" href="/sofie-core/docs/1.37.0/user-guide/intro">1.37.0</a></li></ul></div><a href="https://github.com/nrkno/sofie-core" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_GWqj"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_IT2h colorModeToggle_o_qc"><button class="clean-btn toggleButton_pGki toggleButtonDisabled_vZLo" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_dYsV"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_WRF1"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_WxAN"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_i7DT"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_ecpa" type="button"></button><div class="docPage_ECkl"><aside class="theme-doc-sidebar-container docSidebarContainer_cJdQ"><div class="sidebar_Uz2u"><nav class="menu thin-scrollbar menu_XU2j"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/sofie-core/docs/for-developers/intro">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/sofie-core/docs/for-developers/contribution-guidelines">Contribution Guidelines</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/sofie-core/docs/for-developers/for-blueprint-developers/intro">For Blueprint Developers</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/sofie-core/docs/for-developers/device-integrations/intro">Device Integrations</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/sofie-core/docs/for-developers/libraries">Applications &amp; Libraries</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/sofie-core/docs/for-developers/api-documentation">API Documentation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/sofie-core/docs/for-developers/json-config-schema">JSON Config Schema</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/sofie-core/docs/for-developers/data-model">Data Model</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/sofie-core/docs/for-developers/worker-threads-and-locks">Worker Threads &amp; Locks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/sofie-core/docs/for-developers/api-stability">API Stability</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/sofie-core/docs/for-developers/publications">Publications</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_Essf"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_bqna"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_tUyt"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_ygLL"><div class="docItemContainer_yJzi"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_nmcO" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/sofie-core/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_fy9r"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Data Model</span><meta itemprop="position" content="1"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: Latest</span><div class="tocCollapsible_mE9n theme-doc-toc-mobile tocMobile_By44"><button type="button" class="clean-btn tocCollapsibleButton_Yex_">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Data Model</h1></header><p>Sofie persists the majority of its data in a MongoDB database. This allows us to use Typescript friendly documents,
without needing to worry too much about the strictness of schemas, and allows us to watch for changes happening inside
the database as a way of ensuring that updates are reactive.</p><p>Data is typically pushed to the UI or the gateways through <a href="/sofie-core/docs/for-developers/publications">Publications</a> over the DDP connection that Meteor provides.</p><h2 class="anchor anchorWithStickyNavbar_YDjN" id="collection-ownership">Collection Ownership<a class="hash-link" href="#collection-ownership" title="Direct link to heading">​</a></h2><p>Each collection in MongoDB is owned by a different area of Sofie. In some cases, changes are also made by another area, but we try to keep this to a minimum.<br>
<!-- -->In every case, any layout changes and any scheduled cleanup are performed by the Meteor layer for simplicity.</p><h3 class="anchor anchorWithStickyNavbar_YDjN" id="meteor">Meteor<a class="hash-link" href="#meteor" title="Direct link to heading">​</a></h3><p>This category of collections is rather loosely defined, as it ends up being everything that doesn&#x27;t belong somewhere else</p><p>This consists of anything that is configurable from the Sofie UI, anything needed soley for the UI and some other bits. Additionally, there are some collections which are populated by other portions of a Sofie system, such as by package manager, through an API over DDP.<br>
<!-- -->Currently, there is not a very clearly defined flow for modifying these documents, with the UI often making changes directly with minimal or no validation.</p><p>This includes:</p><ul><li><a href="https://github.com/nrkno/sofie-core/blob/master/packages/corelib/src/dataModel/Blueprint.ts" target="_blank" rel="noopener noreferrer">Blueprints</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/meteor/lib/collections/Buckets.ts" target="_blank" rel="noopener noreferrer">Buckets</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/meteor/lib/collections/CoreSystem.ts" target="_blank" rel="noopener noreferrer">CoreSystem</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/meteor/lib/collections/Evaluations.ts" target="_blank" rel="noopener noreferrer">Evaluations</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/packages/corelib/src/dataModel/ExternalMessageQueue.ts" target="_blank" rel="noopener noreferrer">ExternalMessageQueue</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/packages/corelib/src/dataModel/ExpectedPackageWorkStatuses.ts" target="_blank" rel="noopener noreferrer">ExpectedPackageWorkStatuses</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/packages/corelib/src/dataModel/MediaObjects.ts" target="_blank" rel="noopener noreferrer">MediaObjects</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/meteor/lib/collections/MediaWorkFlows.ts" target="_blank" rel="noopener noreferrer">MediaWorkFlows</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/meteor/lib/collections/MediaWorkFlowSteps.ts" target="_blank" rel="noopener noreferrer">MediaWorkFlowSteps</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/meteor/lib/collections/Organization.ts" target="_blank" rel="noopener noreferrer">Organizations</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/packages/corelib/src/dataModel/PackageInfos.ts" target="_blank" rel="noopener noreferrer">PackageInfos</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/packages/corelib/src/dataModel/PackageContainerPackageStatus.ts" target="_blank" rel="noopener noreferrer">PackageContainerPackageStatuses</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/packages/corelib/src/dataModel/PackageContainerStatus.ts" target="_blank" rel="noopener noreferrer">PackageContainerStatuses</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/packages/corelib/src/dataModel/PeripheralDeviceCommand.ts" target="_blank" rel="noopener noreferrer">PeripheralDeviceCommands</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/packages/corelib/src/dataModel/PeripheralDevice.ts" target="_blank" rel="noopener noreferrer">PeripheralDevices</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/meteor/lib/collections/RundownLayouts.ts" target="_blank" rel="noopener noreferrer">RundownLayouts</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/packages/corelib/src/dataModel/ShowStyleBase.ts" target="_blank" rel="noopener noreferrer">ShowStyleBase</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/packages/corelib/src/dataModel/ShowStyleVariant.ts" target="_blank" rel="noopener noreferrer">ShowStyleVariant</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/meteor/lib/collections/Snapshots.ts" target="_blank" rel="noopener noreferrer">Snapshots</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/packages/corelib/src/dataModel/Studio.ts" target="_blank" rel="noopener noreferrer">Studio</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/meteor/lib/collections/TriggeredActions.ts" target="_blank" rel="noopener noreferrer">TriggeredActions</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/meteor/lib/collections/TranslationsBundles.ts" target="_blank" rel="noopener noreferrer">TranslationsBundles</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/meteor/lib/collections/UserActionsLog.ts" target="_blank" rel="noopener noreferrer">UserActionsLog</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/meteor/lib/collections/Users.ts" target="_blank" rel="noopener noreferrer">Users</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/meteor/lib/collections/Workers.ts" target="_blank" rel="noopener noreferrer">Workers</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/packages/corelib/src/dataModel/WorkerThreads.ts" target="_blank" rel="noopener noreferrer">WorkerThreads</a></li></ul><h3 class="anchor anchorWithStickyNavbar_YDjN" id="ingest">Ingest<a class="hash-link" href="#ingest" title="Direct link to heading">​</a></h3><p>This category of collections is owned by the ingest <a href="/sofie-core/docs/for-developers/worker-threads-and-locks">worker threads</a>, and models a Rundown based on how it is defined by the NRCS.</p><p>These collections are not exposed as writable in Meteor, and are only allowed to be written to by the ingest worker threads.<br>
<!-- -->There is an exception to both of these; Meteor is allowed to write to it as part of migrations, and cleaning up old documents. While the playout worker is allowed to modify certain Segments that are labelled as being owned by playout.</p><p>The collections which are owned by the ingest workers are:</p><ul><li><a href="https://github.com/nrkno/sofie-core/blob/master/packages/corelib/src/dataModel/AdLibActions.ts" target="_blank" rel="noopener noreferrer">AdLibActions</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/packages/corelib/src/dataModel/AdLibPieces.ts" target="_blank" rel="noopener noreferrer">AdLibPieces</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/packages/corelib/src/dataModel/BucketAdLibActions.ts" target="_blank" rel="noopener noreferrer">BucketAdLibActions</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/packages/corelib/src/dataModel/BucketAdLibPieces.ts" target="_blank" rel="noopener noreferrer">BucketAdLibPieces</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/packages/corelib/src/dataModel/ExpectedMediaItems.ts" target="_blank" rel="noopener noreferrer">ExpectedMediaItems</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/packages/corelib/src/dataModel/ExpectedPackages.ts" target="_blank" rel="noopener noreferrer">ExpectedPackages</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/packages/corelib/src/dataModel/ExpectedPlayoutItems.ts" target="_blank" rel="noopener noreferrer">ExpectedPlayoutItems</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/packages/corelib/src/dataModel/IngestDataCache.ts" target="_blank" rel="noopener noreferrer">IngestDataCache</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/packages/corelib/src/dataModel/Parts.ts" target="_blank" rel="noopener noreferrer">Parts</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/packages/corelib/src/dataModel/Pieces.ts" target="_blank" rel="noopener noreferrer">Pieces</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/packages/corelib/src/dataModel/RundownBaselineAdLibActions.ts" target="_blank" rel="noopener noreferrer">RundownBaselineAdLibActions</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/packages/corelib/src/dataModel/RundownBaselineAdLibPieces.ts" target="_blank" rel="noopener noreferrer">RundownBaselineAdLibPieces</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/packages/corelib/src/dataModel/RundownBaselineObjects.ts" target="_blank" rel="noopener noreferrer">RundownBaselineObjects</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/packages/corelib/src/dataModel/Rundowns.ts" target="_blank" rel="noopener noreferrer">Rundowns</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/packages/corelib/src/dataModel/Segments.ts" target="_blank" rel="noopener noreferrer">Segments</a></li></ul><p>These collections model a Rundown from the NRCS in a Sofie form. Almost all of these contain documents which are largely generated by blueprints.<br>
<!-- -->Some of these collections are used by package manager to initiate work, while others form a view of the Rundown for the users, and are used as part of the model for playout.</p><h3 class="anchor anchorWithStickyNavbar_YDjN" id="playout">Playout<a class="hash-link" href="#playout" title="Direct link to heading">​</a></h3><p>This category of collections is owned by the playout <a href="/sofie-core/docs/for-developers/worker-threads-and-locks">worker threads</a>, and is used to model the playout of a Rundown or set of Rundowns.</p><p>During the final stage of an ingest operation, there is a period where the ingest worker aquires a <code>PlaylistLock</code>, so that it can ensure that the RundownPlaylist the Rundown is a part of is updated with any necessary changes following the ingest operation. During this lock, it will also attempt to <a href="/sofie-core/docs/for-developers/for-blueprint-developers/sync-ingest-changes">sync any ingest changes</a> to the PartInstances and PieceInstances, if supported by the blueprints.</p><p>As before, Meteor is allowed to write to these collections as part of migrations, and cleaning up old documents.</p><p>The collections which can only be modified inside of a <code>PlaylistLock</code> are:</p><ul><li><a href="https://github.com/nrkno/sofie-core/blob/master/packages/corelib/src/dataModel/PartInstances.ts" target="_blank" rel="noopener noreferrer">PartInstances</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/packages/corelib/src/dataModel/PieceInstances.ts" target="_blank" rel="noopener noreferrer">PieceInstances</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/packages/corelib/src/dataModel/RundownPlaylists.ts" target="_blank" rel="noopener noreferrer">RundownPlaylists</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/packages/corelib/src/dataModel/Timelines.ts" target="_blank" rel="noopener noreferrer">Timelines</a></li><li><a href="https://github.com/nrkno/sofie-core/blob/master/packages/corelib/src/dataModel/TimelineDatastore.ts" target="_blank" rel="noopener noreferrer">TimelineDatastore</a></li></ul><p>These collections are used in combination with many of the ingest collections, to drive playout.</p><h4 class="anchor anchorWithStickyNavbar_YDjN" id="rundownplaylist">RundownPlaylist<a class="hash-link" href="#rundownplaylist" title="Direct link to heading">​</a></h4><p>RundownPlaylists are a Sofie invention designed to solve one problem; in some NRCS it is beneficial to build a show across multiple Rundowns, which should then be concatenated for playout.<br>
<!-- -->In particular, MOS has no concept of a Playlist, only Rundowns, and it was here where we need to be able to combine multiple Rundowns.</p><p>This functionality can be used to either break down long shows into managable chunks, or to indicate a different type of show between the each portion.</p><p>Because of this, RundownPlaylists are largely missing from the ingest side of Sofie. We do not expose them in the ingest APIs, or do anything with them throughout the majority of the blueprints generating a Rundown.<br>
<!-- -->Instead, we let the blueprints specify that a Rundown should be part of a RundownPlaylist by setting the <code>playlistExternalId</code> property, where multiple Rundowns in a Studio with the same id will be grouped into a RundownPlaylist.<br>
<!-- -->If this property is not used, we automatically generate a RundownPlaylist containing the Rundown by itself.</p><p>It is during the final stages of an ingest operation, where the RundownPlaylist will be generated (with the help of blueprints), if it is necessary.<br>
<!-- -->Another benefit to this approach, is that it allows for very cheaply and easily moving Rundowns between RundownPlaylists, even safely affecting a RundownPlaylist that is currently on air.</p><h4 class="anchor anchorWithStickyNavbar_YDjN" id="part-vs-partinstance-and-piece-vs-pieceinstance">Part vs PartInstance and Piece vs PieceInstance<a class="hash-link" href="#part-vs-partinstance-and-piece-vs-pieceinstance" title="Direct link to heading">​</a></h4><p>In the early days of Sofie, we had only Parts and Pieces, no PartInstances and PieceInstances.</p><p>This quickly became costly and complicated to handle cases where the user used Adlibs in Sofie. Some of the challenges were:</p><ul><li>When a Part is deleted from the NRCS and that part is on air, we don&#x27;t want to delete it in Sofie immediately</li><li>When a Part is modified in the NRCS and that part is on air, we may not want to apply all of the changes to playout immediately</li><li>When a Part has finished playback and is set-as-next again, we need to make sure to discard any changes made by the previous playout, and restore it to as if was refreshly ingested (including the changes we ignored while it was on air)</li><li>When creating an adlib part, we need to be sure that an ingest operation doesn&#x27;t attempt to delete it, until playout is finished with it.</li><li>After using an adlib in a part, we need to remove the piece it created when we set-as-next again, or reset the rundown</li><li>When an earlier part is removed, where an infinite piece has spanned into the current part, we may not want to remove that infinite piece</li></ul><p>Our solution to some of this early on was to not regenerate certain Parts when receiving ingest operations for them, and to defer it until after that Part was off air. While this worked, it was not optimal to re-run ingest operations like that while doing a take. This also required the blueprint api to generate a single part in each call, which we were starting to find limiting. This was also problematic when resetting a rundown, as that would often require rerunning ingest for the whole rundown, making it a notably slow operation.</p><p>At this point in time, Adlib Actions did not exist in Sofie. They are able to change almost every property of a Part of Piece that ingest is able to define, which makes the resetting process harder.</p><p>PartInstances and PieceInstances were added as a way for us to make a copy of each Part and Piece, as it was selected for playout, so that we could allow ingest without risking affecting playout, and to simplify the cleanup performed. The PartInstances and PieceInstances are our record of how the Rundown was played, which we can utilise to output metadata such as for chapter markers on a web player. In earlier versions of Sofie this was tracked independently with an <code>AsRunLog</code>, which resulted in odd issues such as having <code>AsRunLog</code> entries which refered to a Part which no longer existed, or whose content was very different to how it was played.</p><p>Later on, this separation has allowed us to more cleanly define operations as ingest or playout, and allows us to run them in parallel with more confidence that they won&#x27;t accidentally wipe out each others changes. Previously, both ingest and playout operations would be modifying documents in the Piece and Part collections, making concurrent operations unsafe as they could be modifying the same Part or Piece.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/nrkno/sofie-core/edit/master/packages/documentation/docs/for-developers/data-model.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_OMbO" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vA0S"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/sofie-core/docs/for-developers/json-config-schema"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">JSON Config Schema</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/sofie-core/docs/for-developers/worker-threads-and-locks"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Worker Threads &amp; Locks</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_jWtb thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#collection-ownership" class="table-of-contents__link toc-highlight">Collection Ownership</a><ul><li><a href="#meteor" class="table-of-contents__link toc-highlight">Meteor</a></li><li><a href="#ingest" class="table-of-contents__link toc-highlight">Ingest</a></li><li><a href="#playout" class="table-of-contents__link toc-highlight">Playout</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" position="left" href="/sofie-core/docs/user-guide/intro">User Guide</a></li><li class="footer__item"><a class="footer__link-item" position="left" href="/sofie-core/docs/for-developers/intro">For Developers</a></li><li class="footer__item"><a class="footer__link-item" position="left" href="/sofie-core/releases">Releases</a></li></ul></div><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://join.slack.com/t/sofietv/shared_invite/zt-2bfz8l9lw-azLeDB55cvN2wvMgqL1alA" target="_blank" rel="noopener noreferrer" class="footer__link-item">Sofie Slack Community<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_GWqj"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" position="right" href="/sofie-core/docs/about-sofie">About Sofie</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ©2024 Norsk rikskringkasting AS and Contributors</div></div></div></footer></div>
<script src="/sofie-core/assets/js/runtime~main.2e85f4d6.js"></script>
<script src="/sofie-core/assets/js/main.91440fd8.js"></script>
</body>
</html>